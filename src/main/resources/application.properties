spring.application.name=wq

# 服务器配置
server.port=8080

# 数据库配置
spring.datasource.url=jdbc:mysql://localhost:3306/wanqing?useUnicode=true&characterEncoding=utf-8&serverTimezone=Asia/Shanghai&useSSL=false&allowPublicKeyRetrieval=true
spring.datasource.username=root
spring.datasource.password=root
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.type=com.zaxxer.hikari.HikariDataSource

# HikariCP 连接池配置
# 连接池大小（推荐公式：core_count * 2 + effective_spindle_count）
spring.datasource.hikari.maximum-pool-size=20
# 最小空闲连接数
spring.datasource.hikari.minimum-idle=5
# 连接超时时间（毫秒）
spring.datasource.hikari.connection-timeout=30000
# 空闲连接最大存活时间（毫秒，10分钟）
spring.datasource.hikari.idle-timeout=600000
# 连接最大存活时间（毫秒，30分钟）
spring.datasource.hikari.max-lifetime=1800000
# 连接测试查询（MySQL推荐使用 SELECT 1）
spring.datasource.hikari.connection-test-query=SELECT 1

# 连接池性能优化
# 预编译语句池大小（Per connection）
spring.datasource.hikari.prepared-statement-cache-size=250
# 每个连接的最小空闲连接数（建议保持和 minimum-idle 一致）
spring.datasource.hikari.pool-name=WqHikariPool

# 连接泄露检测（开发环境启用，生产环境建议关闭）
# spring.datasource.hikari.leak-detection-threshold=60000

# HikariCP 其他配置
# 允许连接池在启动时初始化（加速首次访问）
spring.datasource.hikari.initialization-fail-timeout=1
# 设置只读（从库配置时使用）
# spring.datasource.hikari.read-only=false

# JPA配置
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect

# Knife4j配置
knife4j.enable=true
knife4j.setting.enable-swagger-models=true
knife4j.setting.enable-document-manage=true
knife4j.setting.enable-version=true
knife4j.setting.enable-request-cache=true
knife4j.setting.enable-filter-multipart-apis=true
knife4j.setting.enable-filter-multipart-api-method-type=POST

# Swagger配置
springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.path=/swagger-ui.html

# Spring Security 配置
# 完全开放模式（无需认证）
# 如果需要启用认证，请参考 SecurityConfig.java 文件中的注释
spring.security.filter.order=10

# 缓存配置（仅使用 Caffeine 本地缓存）
# 如果需要 Redis 分布式缓存，请参考 Redis安装指南.md
spring.cache.type=caffeine
spring.cache.cache-names=userCache,productCache,queryCache,demoCache
spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=10m